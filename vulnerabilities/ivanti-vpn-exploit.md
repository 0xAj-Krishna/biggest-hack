# Ivanti VPN Exploit Chain (CVE-2023-46805, CVE-2024-21887)

**CVE:** CVE-2023-46805, CVE-2024-21887  
**CWE:** CWE-287 (Improper Authentication), CWE-77 (Command Injection)  
**CVSS:** 9.1 (Critical)  

---

## 📝 What happened
In January 2024, security researchers discovered that attackers were exploiting a **two-bug chain** in Ivanti Connect Secure VPN appliances.  
- The first flaw was an **authentication bypass** (CVE-2023-46805) that let hackers skip the login process.  
- The second was a **command injection** bug (CVE-2024-21887) that let them run arbitrary system commands.  
Combined, these vulnerabilities gave attackers **full control of VPN devices**.  
Hackers used the flaws to install webshells, steal credentials, and move laterally within networks.  
The U.S. CISA even issued an **emergency directive** forcing agencies to patch or rebuild devices immediately.  

---

## 💥 Impact
- Hundreds of organizations across industries were compromised.  
- Attackers bypassed **MFA entirely** since the exploit worked pre-authentication.  
- Sensitive credentials and network access were stolen at scale.  

---

## 🔑 Lesson learned
- Edge-facing devices like VPNs are **prime attack targets**.  
- MFA is not effective if the device itself is compromised pre-auth.  
- Continuous monitoring and anomaly detection on VPNs is critical.  

---

## 🛡️ Mitigation / Recommendation
- Patch or rebuild affected appliances immediately.  
- Rotate all credentials stored or passed through the VPN.  
- Hunt for persistence (webshells, rogue accounts).  
- Restrict management access to internal networks only.  

---

## 🔗 Sources
- [NVD – CVE-2024-21887](https://nvd.nist.gov/vuln/detail/CVE-2024-21887)  
- [Mandiant Report](https://www.mandiant.com/resources/blog/ivanti-connect-secure-0days)  
- [CISA Advisory](https://www.cisa.gov/news-events/alerts/2024/01/19/ivanti-0-days)  
